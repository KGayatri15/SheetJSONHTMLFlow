<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="../beauty/signup.css"/>
    <script type="text/javascript" src="../function/allMerged_V5.js"></script>
    <script type="text/javascript" src="../function/actionHelpers.js"></script>
    <script type="text/javascript" src="../form/sysDataSet.js"></script>
    <script type="text/javascript" src="../form/actionContent_UserData.js"></script>
    <script type="text/javascript" src="../form/appViewTemplates.js"></script>
  </head>
<body>
<script>
  const scriptURL = 'https://script.google.com/macros/s/AKfycbwfDv5y9elBrAOqV8f2bwNDRVTc2cYpj9sHUFJ-z1n2-jGWmA1K0x3wIDmWX6t1w3xFPw/exec';
  window.onload = async(event)=>{
            event.preventDefault();
            var form = new Entity(SignUpJSON,document.getElementsByTagName('body')[0]);
  }
async function submitData(event){
    event.preventDefault();
    var json = {
        'EmailId':document.getElementById('email').value,
        'Password':document.getElementById('psw').value,
        'Username':document.getElementById('username').value
    };
    console.log(json);
    await fetch(scriptURL,{method:'POST',body:JSON.stringify(json)})
    .then(res => {
      console.log("Status of Sign Up POST request:- " + res.status);
      return res.text();
    })
    .then((res)=>{
      var response = JSON.parse(res);
      if(response.result == 'success'){
         console.log('Registered Successfully');
         localStorage.setItem('LoginEhh'+document.getElementById('email').value,true);
         window.location.href = './indexActionSpace_V5Treeview.html';
      }else if(response.result == 'failed'){
        console.log('User already exists Sign In to your account');
        window.location.href = './signin.html';
      }else{
        console.log('Encountered an error.Try Again..Thank You for your patience !');
      }
    })
    .catch(err=>console.log(err));
    document.getElementById('email').value = '';
    document.getElementById('psw').value = '';
    document.getElementById('username').value = '';

}
</script>

</body>
</html>
